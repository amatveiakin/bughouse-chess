<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="907px" preserveAspectRatio="none" style="width:695px;height:907px;background:#FFFFFF;" version="1.1" viewBox="0 0 695 907" width="695px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="114" x="289.5" y="29.9659">Bughouse oauth</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="79.1358" y2="869.7862"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="444" x2="444" y1="79.1358" y2="869.7862"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="658" x2="658" y1="79.1358" y2="869.7862"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="5" y="45.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="12" y="67.0339">Browser</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="5" y="868.7862"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="12" y="890.7522">Browser</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="416" y="45.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="423" y="67.0339">Server</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="416" y="868.7862"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="423" y="890.7522">Server</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="628" y="45.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="635" y="67.0339">Google</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="628" y="868.7862"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="635" y="890.7522">Google</text><polygon fill="#181818" points="432.5,108.8419,442.5,112.8419,432.5,116.8419,436.5,112.8419" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="39.5" x2="438.5" y1="112.8419" y2="112.8419"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="46.5" y="107.0328">GET bughouse.pro/auth/login</text><path d="M192,125.8419 L192,170.8419 L439,170.8419 L439,135.8419 L429,125.8419 L192,125.8419 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M429,125.8419 L429,135.8419 L439,135.8419 L429,125.8419 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="198" y="144.7389">Generates redirect URL using oauth2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="198" y="162.4449">asking for openid+email+profile scope</text><polygon fill="#181818" points="50.5,213.6659,40.5,217.6659,50.5,221.6659,46.5,217.6659" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="443.5" y1="217.6659" y2="217.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="56.5" y="194.1509">Redirects to accounts.google.com/...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="56.5" y="211.8569">sets the CSRF cookie=&lt;csrf_token&gt;</text><polygon fill="#181818" points="646.5,245.3719,656.5,249.3719,646.5,253.3719,650.5,249.3719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="39.5" x2="652.5" y1="249.3719" y2="249.3719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="46.5" y="243.5629">Completes the login &amp; consent form</text><path d="M540,262.3719 L540,289.3719 L653,289.3719 L653,272.3719 L643,262.3719 L540,262.3719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M643,262.3719 L643,272.3719 L653,272.3719 L643,262.3719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="546" y="281.2689">Verifies identity</text><polygon fill="#181818" points="50.5,314.784,40.5,318.784,50.5,322.784,46.5,318.784" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="657.5" y1="318.784" y2="318.784"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429" x="56.5" y="312.975">Redirects to bughouse.pro/auth/session?code=&lt;...&gt;&amp;state=&lt;csrf_token&gt;</text><polygon fill="#181818" points="432.5,346.49,442.5,350.49,432.5,354.49,436.5,350.49" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="39.5" x2="438.5" y1="350.49" y2="350.49"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381" x="46.5" y="344.681">GET bughouse.pro/auth/session?code=&lt;...&gt;&amp;state=&lt;csrf_token&gt;</text><path d="M223,363.49 L223,408.49 L439,408.49 L439,373.49 L429,363.49 L223,363.49 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M429,363.49 L429,373.49 L439,373.49 L429,363.49 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="229" y="382.387">Checks csrf token and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="229" y="400.093">exchanges code for access token</text><polygon fill="#181818" points="646.5,433.608,656.5,437.608,646.5,441.608,650.5,437.608" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="444.5" x2="652.5" y1="437.608" y2="437.608"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="451.5" y="431.799">Code</text><path d="M523,450.608 L523,477.608 L653,477.608 L653,460.608 L643,450.608 L523,450.608 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M643,450.608 L643,460.608 L653,460.608 L643,450.608 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="529" y="469.505">Part of oauth2 API</text><polygon fill="#181818" points="455.5,503.0201,445.5,507.0201,455.5,511.0201,451.5,507.0201" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="449.5" x2="657.5" y1="507.0201" y2="507.0201"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="461.5" y="501.2111">Access token</text><polygon fill="#181818" points="646.5,534.7261,656.5,538.7261,646.5,542.7261,650.5,538.7261" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="444.5" x2="652.5" y1="538.7261" y2="538.7261"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="451.5" y="532.9171">GET userinfo?access_token=&lt;...&gt;</text><path d="M558,551.7261 L558,578.7261 L653,578.7261 L653,561.7261 L643,551.7261 L558,551.7261 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M643,551.7261 L643,561.7261 L653,561.7261 L643,551.7261 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="564" y="570.6231">Userinfo API</text><polygon fill="#181818" points="455.5,604.1381,445.5,608.1381,455.5,612.1381,451.5,608.1381" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="449.5" x2="657.5" y1="608.1381" y2="608.1381"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="461.5" y="602.3291">userinfo {...}</text><path d="M204,621.1381 L204,648.1381 L439,648.1381 L439,631.1381 L429,621.1381 L204,621.1381 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M429,621.1381 L429,631.1381 L439,631.1381 L429,621.1381 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="210" y="640.0351">Starts a session with user info inside</text><polygon fill="#181818" points="50.5,673.5501,40.5,677.5501,50.5,681.5501,46.5,677.5501" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="443.5" y1="677.5501" y2="677.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="56.5" y="671.7411">"Login successful" + session cookie</text><polygon fill="#181818" points="432.5,705.2562,442.5,709.2562,432.5,713.2562,436.5,709.2562" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="39.5" x2="438.5" y1="709.2562" y2="709.2562"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="46.5" y="703.4472">Handshake + cookie on websocket endpoint</text><path d="M310,722.2562 L310,767.2562 L439,767.2562 L439,732.2562 L429,722.2562 L310,722.2562 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M429,722.2562 L429,732.2562 L439,732.2562 L429,722.2562 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="316" y="741.1532">Checks the cookie</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="316" y="758.8592">and Origin header</text><polygon fill="#181818" points="50.5,792.3742,40.5,796.3742,50.5,800.3742,46.5,796.3742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="443.5" y1="796.3742" y2="796.3742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="56.5" y="790.5652">Websocket accepted</text><path d="M256,809.3742 L256,854.3742 L439,854.3742 L439,819.3742 L429,809.3742 L256,809.3742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M429,809.3742 L429,819.3742 L439,819.3742 L429,809.3742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="262" y="828.2712">Knows the identity behind</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="262" y="845.9772">the websocket at this point</text><!--SRC=[ZLF1RjD04BtxAqOzz1BgI1mZIDL6fI0gKIKKBf7GPZssLtPsh9qr1I7-dTbTnn6A6_Le-xqtxxqPU-DRXDk-ggbd15AzhxFirj4pexjQRj3zHBU0-xkli1j0UUTe7d3pbYfZCqiUeSNI0vKm4j2YKnuP71R6eVRmj7w0desjqfItRxPMSHEUIt907LfJp72lJ3kJ2QKHNwpbTPOqhvQ3gmMi1qa6Jw2qfjvwpYkYgiLSqtwUv_dMCWP0ZR3Qh3-09ceCld-dsPK_F3LebyUOzv6wW1NjknQ3wy2ByU1IgA9bVR2v_p_jWVSDdIcDq4mXGED_P-dBIvvFgsHaDcIlDHLYKlmlBzbBVoyOFh-NrubDxcrLesuO0WuY3fGjjXP_wLhPIX86pRWmwLt69D2uecEH1KvNzQXSV4ut03UFdyQk3XvkpYc7n1BM6LlITVAG0gMWqqEV1iBak8CQ_161lzErRBpOPb0mL0lFnjUH2P5gBClgJo_ruY7U4FVHQDct5p0RDT99dYxrerJEjMfGi0a3OIBkc7I37j0M7Hdhpsum770Yoszc2_ZYJ71IeohGdHhzFgg7JZkFnRJwPok4A7uuTTXXRSADX9T7ayeBoZ14f_y0]--></g></svg>